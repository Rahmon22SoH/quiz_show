# Обзор модуля Quiz

## 1. Введение
Модуль Quiz предназначен для проведения викторин в вашем проекте. Пользователь может принимать участие в викторине, отвечать на вопросы и получать результаты. Модуль интегрируется с базой данных (SQLite) для хранения информации о викторинах и результатах участников.

## 2. Структура модуля (app/quiz)
- **__init__.py**: Регистрирует Blueprint для маршрутов викторины, обеспечивая интеграцию с основным приложением Flask.
- **models.py**: Определяет SQLAlchemy-модель (или модели) для хранения данных викторины. Здесь могут храниться информация о викторине, результаты и другие связанные данные.
- **views.py**: Содержит маршруты, обрабатывающие HTTP-запросы, связанные с викторинами. Здесь реализована логика для отображения страниц викторины и обработки форм с ответами.
- **utils.py**: Вспомогательные функции, поддерживающие работу викторины, например, подготовка данных и обработка результатов. Функции из этого файла вызываются представлениями для упрощения основной логики.

## 3. Логика работы модуля Quiz
### Инициализация
При запуске приложения, в файле __init__.py данного модуля производится регистрация Blueprint, что позволяет выделить маршруты викторины в отдельный модуль и управлять ими централизованно.

### Работа с данными
- В **models.py** определена модель викторины, которая хранит данные, связанные с прохождением викторины, такие как идентификатор, название, результаты и время прохождения. Эти данные сохраняются в базе данных SQLite.
- При получении запроса для участия в викторине (обработанном в **views.py**), данные формы передаются во вспомогательные функции из **utils.py** для обработки и подготовки необходимой информации.

### Представления
В **views.py** реализована логика отображения страницы викторины и обработки ответов пользователей. После прохождения викторины, результаты отправляются в базу данных, и выводятся на экран в виде итогового результата.

## 4. Связи с другими модулями
Модуль Quiz взаимодействует с:
- **Модулем аутентификации (auth)**: для получения данных о пользователе, участвующем в викторине.
- **Административным модулем (admin)**: для отображения и анализа результатов викторин.
- **Общим функционалом приложения**: использует базу данных SQLite и общие расширения (extensions.py) для доступа к данным.

## 5. Диаграмма работы модуля Quiz

         [Пользователь]
               │
               ▼
         Открытие страницы викторины (/quiz)
               │
               ▼
      Обработка запроса в views.py
               │
               ▼
   Вызов вспомогательных функций из utils.py
               │
               ▼
     Сохранение/обновление данных в models.py (БД SQLite)
               │
               ▼
   Отображение результатов участнику

## 6. Пример рабочего процесса
1. Пользователь заходит на страницу викторины.
2. Маршрут из **views.py** отображает страницу с вопросами викторины.
3. После отправки ответов данные обрабатываются вспомогательными функциями из **utils.py**.
4. Результаты сохраняются в базе данных через модель в **models.py**.
5. Пользователю отображается итоговый результат, а администратор может просматривать статистику в административном разделе. 

# Работа функции блокировки пользователя
Как это работает в целом:
Администратор нажимает кнопку "Заблокировать" для пользователя
Вызывается функция toggle_user_status
Функция вызывает метод user.block(), который устанавливает active=False и is_locked=True
Изменения сохраняются в базе данных
Если заблокированный пользователь пытается зайти на сайт, функция check_user_session обнаруживает, что user.is_active=False, и выполняет выход пользователя
Пользователь видит сообщение о блокировке
Эта система обеспечивает надежную блокировку пользователей и предотвращает доступ заблокированных пользователей к сайту.
